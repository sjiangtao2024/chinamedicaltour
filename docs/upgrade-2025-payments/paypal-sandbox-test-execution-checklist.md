# PayPal 沙盒支付测试执行清单（模板）

- 测试环境：Sandbox
- PayPal App：`<client_id>`
- Webhook ID：`<webhook_id>`
- 执行人：`<name>`
- 执行日期：`YYYY-MM-DD`

## P0 核心流程

### A01 正常购买
- 结果：通过/失败
- 证据：订单号、capture_id、付款截图、收据/发票号
- 备注：

### A02 取消支付
- 结果：通过/失败
- 证据：取消页截图、订单状态
- 备注：

### A03 重复点击/重复订单
- 结果：通过/失败
- 证据：订单列表截图、重复订单数
- 备注：

### D01 优惠券
- 结果：通过/失败
- 证据：折扣前后金额、订单记录
- 备注：

## P1 安全与合规

### B01 Webhook 签名验证
- 结果：通过/失败
- 证据：真实请求 200 + 伪造请求 400/401 记录
- 备注：

### B02 幂等性/重放
- 结果：通过/失败
- 证据：第二次 capture 失败响应
- 备注：

### B03 证据链字段完整
- 结果：通过/失败
- 证据：DB 记录（terms_version、terms_accepted_at、ip、ua）
- 备注：

### B04 条款版本一致
- 结果：通过/失败
- 证据：前端展示版本与订单一致
- 备注：

## P2 退款与对账

### C01 手动退款
- 结果：通过/失败
- 证据：PayPal 退款记录 + 订单状态变更
- 备注：

### C02 部分退款（如支持）
- 结果：通过/失败
- 证据：退款金额与订单关联
- 备注：

### C03 对账一致
- 结果：通过/失败
- 证据：对账导出记录
- 备注：
